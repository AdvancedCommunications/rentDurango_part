(function(d){function g(a,b){b?d(a).addClass("ui-state-disabled"):d(a).removeClass("ui-state-disabled")}d.widget("ui.carousel",{_init:function(){var a=this.options,b=this.element;this.orientation=this.options.orientation=="vertical"?"vertical":"horizontal";this.running=false;this.curr=a.start;this._detectNavigation();b.addClass("ui-carousel ui-carousel-"+this.orientation+" ui-widget ui-widget-content ui-corner-all ui-helper-clearfix");this.slide=d(">ul, .ui-carousel-clip>ul",b).addClass("ui-carousel-slide");
this.clip=d(".ui-carousel-clip",b);if(this.clip.size()===0){this.slide.wrap('<div class="ui-carousel-clip"></div>');this.clip=d(".ui-carousel-clip",b)}this.rebuild(true);this.autoReset()},rebuild:function(a){var b=this.options;if(this.curr>=this.itemLength)this.curr-=this.itemLength;else if(this.curr<0)this.curr+=this.itemLength;this.slide.children(".ui-carousel-buffer").remove();this.offset=0;this.li=this.slide.children().addClass("ui-carousel-item");if(b.circular){var c=this.li;this.offset=Math.max(b.visible,
b.scroll);this.slide.prepend(c.slice(c.size()-this.offset).clone().addClass("ui-carousel-buffer")).append(c.slice(0,this.offset).clone().addClass("ui-carousel-buffer"));this.li=this.slide.children()}this.itemLength=this.li.size()-2*this.offset;a&&this.element.show();this.refresh()},prev:function(){return this._go(this.curr-this.options.scroll)},next:function(){return this._go(this.curr+this.options.scroll)},visible:function(a){if(a===undefined)a=this.curr;return this.slide.children().slice(a,a+this.options.visible)},
at:function(){return this.curr},view:function(a){var b=this.options,c=this.curr;if(!(a>c&&a<=c+b.visible)){b=b.scroll;var e=0;e=a<=c?c-(Math.floor((c-a)/b)*b+b):c+(Math.floor((a-c)/b)*b-b);return this._go(e)}},reset:function(){var a=this.options;this.curr!=a.start&&this.set(a.start)},refresh:function(){var a=this.options,b=this.orientation!="horizontal",c=b?"height":"width";this.animCss=b?"top":"left";this.li.css({width:"",height:""});this.liSize=b?this.li.outerHeight(true):this.li.outerWidth(true);
this.li.css({width:this.li.width(),height:this.li.height()});this.slide.css(c,this.liSize*(this.itemLength+2*this.offset));this.clip.css(c,this.liSize*a.visible);this.set(this.curr);this._updateNav()},autoReset:function(){var a=this.options;if(typeof this.autoTimer!=="undefined"){clearTimeout(this.autoTimer);delete this.autoTimer}if(a.auto){var b=this;this.autoTimer=setTimeout(function(){b.next()},a.auto)}},auto:function(a){this.options.auto=a;this.autoReset()},_go:function(a){var b=this.options,
c=b.visible;if(!b.circular){if(a>this.itemLength-c)a=this.itemLength-c;if(a<0)a=0}if(!(this.running||a==this.curr)){var e=this.curr,h=this.element;c=this.itemLength;var i=this.offset,f=this;this.running=true;if(b.circular)if(a<-i){e+=c;a+=c;this.set(e)}else if(a>c){e-=c;a-=c;this.set(e)}this.curr=a;a+=i;b.beforeStart.call(h,this.visible(this.curr),this.visible(a));this.slide.animate(this.animCss=="left"?{left:-(a*this.liSize)}:{top:-(a*this.liSize)},b.speed,b.easing,function(){f.running=false;f._updateNav();
f.autoReset();b.afterEnd.call(h,f.visible(a),f.visible(e))});return true}return false},set:function(a){this.curr=a;this.slide.css(this.animCss,-((a+this.offset)*this.liSize)+"px")},_updateNav:function(){var a=this.options;if(a.circular){var b=this.itemLength<=a.visible;g(this.nav.prev,b);g(this.nav.next,b)}else{b=this.visible(this.curr-1).length===0;a=this.visible(this.curr+a.visible).length===0;g(this.nav.prev,b);g(this.nav.next,a)}},_detectNavigation:function(){var a=this,b=" ui-icon-triangle-1-",
c=" ui-icon-triangle-1-";if(this.orientation=="horizontal"){b+="w";c+="e"}else{b+="n";c+="s"}this.nav={};this.nav.prev=d(".ui-carousel-prev",this.element).addClass("ui-icon"+b).click(function(e){e.preventDefault();d(this).not(".ui-state-disabled").length&&a.prev()});this.nav.next=d(".ui-carousel-next",this.element).addClass("ui-icon"+c).click(function(e){e.preventDefault();d(this).not(".ui-state-disabled").length&&a.next()})}});d.extend(d.ui.carousel,{defaults:{auto:null,speed:200,easing:null,orientation:"horizontal",
circular:true,visible:3,start:0,scroll:1,beforeStart:function(){},afterEnd:function(){}}})})(jQuery);
